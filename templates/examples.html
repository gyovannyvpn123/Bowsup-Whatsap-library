<!DOCTYPE html>
<html data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examples - Bocksup WhatsApp Library</title>
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">Bocksup</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/docs">Documentation</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="/examples">Examples</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-5">
        <div class="row">
            <div class="col-lg-10 mx-auto">
                <h1 class="display-4 text-center mb-4">Examples</h1>
                
                <div class="alert alert-info mb-4">
                    <p class="mb-0"><strong>Note:</strong> These examples demonstrate the intended API usage. Complete WhatsApp server functionality requires the implementation steps detailed in the documentation.</p>
                </div>
                
                <!-- Basic Echo Bot Example -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h3 class="mb-0">Basic Echo Bot</h3>
                    </div>
                    <div class="card-body">
                        <p>A simple bot that echoes back any received message:</p>
                        <pre class="bg-dark text-light p-3 rounded"><code>"""
Basic echo bot example using Bocksup.

This bot connects to WhatsApp and echoes back any received message.
"""

import asyncio
import logging
from bocksup import create_client

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger("echo_bot")

# WhatsApp credentials
PHONE_NUMBER = "your_phone_number"  # e.g., "12025550108"
PASSWORD = "your_password"          # Optional, if not provided QR auth will be used

async def main():
    # Create client
    client = create_client(PHONE_NUMBER, PASSWORD)
    
    # Register message handler
    client.register_message_handler(message_handler)
    
    # Connect to WhatsApp
    try:
        logger.info("Connecting to WhatsApp...")
        connected = await client.connect()
        
        if connected:
            logger.info("Connected to WhatsApp!")
            
            # Keep the connection alive
            while True:
                await asyncio.sleep(60)
                
    except Exception as e:
        logger.error(f"Error: {e}")
    finally:
        # Disconnect when done
        await client.disconnect()
        logger.info("Disconnected from WhatsApp")

async def message_handler(message_data):
    """Handle incoming messages by echoing them back."""
    if 'text' in message_data and message_data.get('type') == 'text':
        sender = message_data.get('from')
        text = message_data.get('text')
        
        logger.info(f"Message from {sender}: {text}")
        
        # Echo the message back
        if sender:
            reply_text = f"You said: {text}"
            await client.send_text_message(sender, reply_text)
            logger.info(f"Sent echo reply to {sender}")

if __name__ == "__main__":
    asyncio.run(main())</code></pre>
                    </div>
                </div>
                
                <!-- WhatsApp Bot with Commands -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h3 class="mb-0">WhatsApp Bot with Commands</h3>
                    </div>
                    <div class="card-body">
                        <p>A more advanced bot that responds to specific commands:</p>
                        <pre class="bg-dark text-light p-3 rounded"><code>"""
Command-based WhatsApp bot example using Bocksup.

This bot handles specific commands like:
- !help - Show help message
- !time - Display the current time
- !echo [text] - Echo back text
"""

import asyncio
import logging
import time
from datetime import datetime
from bocksup import create_client

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger("command_bot")

# WhatsApp credentials
PHONE_NUMBER = "your_phone_number"
PASSWORD = None  # Use QR code authentication

# Bot commands
COMMANDS = {
    "!help": "Show this help message",
    "!time": "Show the current time",
    "!echo": "Echo back the text after the command"
}

async def main():
    # Create client
    client = create_client(PHONE_NUMBER, PASSWORD)
    
    # Register handlers
    client.register_message_handler(message_handler)
    
    # Connect to WhatsApp
    try:
        logger.info("Connecting to WhatsApp...")
        connected = await client.connect()
        
        if connected:
            logger.info("Connected to WhatsApp!")
            
            # Keep the connection alive
            while True:
                await asyncio.sleep(60)
                
    except Exception as e:
        logger.error(f"Error: {e}")
    finally:
        # Disconnect when done
        await client.disconnect()
        logger.info("Disconnected from WhatsApp")

async def message_handler(message_data):
    """Handle incoming messages and process commands."""
    if 'text' in message_data and message_data.get('type') == 'text':
        sender = message_data.get('from')
        text = message_data.get('text', '').strip()
        
        if not sender:
            return
            
        # Process commands
        if text.startswith('!'):
            await process_command(sender, text)
        
async def process_command(sender, text):
    """Process bot commands."""
    parts = text.split(' ', 1)
    command = parts[0].lower()
    args = parts[1] if len(parts) > 1 else ''
    
    if command == '!help':
        # Send help message
        help_text = "Available commands:\\n"
        for cmd, desc in COMMANDS.items():
            help_text += f"{cmd} - {desc}\\n"
        await client.send_text_message(sender, help_text)
        
    elif command == '!time':
        # Send current time
        now = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        await client.send_text_message(sender, f"Current time: {now}")
        
    elif command == '!echo':
        # Echo back the text
        if args:
            await client.send_text_message(sender, args)
        else:
            await client.send_text_message(sender, "Echo what? Use !echo [text]")
            
    else:
        # Unknown command
        await client.send_text_message(
            sender, 
            f"Unknown command: {command}\\nType !help for available commands"
        )

# Global client instance
client = None

if __name__ == "__main__":
    asyncio.run(main())</code></pre>
                    </div>
                </div>
                
                <!-- Group Management Example -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h3 class="mb-0">Group Management</h3>
                    </div>
                    <div class="card-body">
                        <p>Managing WhatsApp groups with Bocksup:</p>
                        <pre class="bg-dark text-light p-3 rounded"><code>"""
WhatsApp group management example using Bocksup.

This example demonstrates:
- Creating groups
- Adding participants
- Sending messages to groups
- Handling group events
"""

import asyncio
import logging
from bocksup import create_client

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger("group_manager")

# WhatsApp credentials
PHONE_NUMBER = "your_phone_number"
PASSWORD = "your_password"

# Example group data
GROUP_NAME = "Bocksup Test Group"
PARTICIPANTS = [
    "1234567890",  # Replace with actual phone numbers
    "0987654321"
]

async def main():
    # Create client
    client = create_client(PHONE_NUMBER, PASSWORD)
    
    # Register handlers
    client.register_message_handler(message_handler)
    client.register_group_notification_handler(group_notification_handler)
    
    # Connect to WhatsApp
    try:
        logger.info("Connecting to WhatsApp...")
        connected = await client.connect()
        
        if connected:
            logger.info("Connected to WhatsApp!")
            
            # Create a new group
            group_id = await create_test_group(client)
            
            # Send welcome message
            if group_id:
                await client.send_text_message(
                    group_id, 
                    "Welcome to the Bocksup test group!"
                )
            
            # Keep the connection alive
            while True:
                await asyncio.sleep(60)
                
    except Exception as e:
        logger.error(f"Error: {e}")
    finally:
        # Disconnect when done
        await client.disconnect()
        logger.info("Disconnected from WhatsApp")

async def create_test_group(client):
    """Create a test group and add participants."""
    try:
        # Create the group
        logger.info(f"Creating group: {GROUP_NAME}")
        group_id = await client.create_group(GROUP_NAME, PARTICIPANTS)
        logger.info(f"Group created with ID: {group_id}")
        
        # Add more participants if needed
        # await client.add_participant_to_group(group_id, "5551234567")
        
        return group_id
    except Exception as e:
        logger.error(f"Failed to create group: {e}")
        return None

async def message_handler(message_data):
    """Handle incoming messages."""
    if message_data.get('is_group') and 'text' in message_data:
        group_id = message_data.get('from')
        sender = message_data.get('participant')
        text = message_data.get('text')
        
        logger.info(f"Group message from {sender} in group {group_id}: {text}")
        
        # You can respond to specific group messages here

async def group_notification_handler(notification_data):
    """Handle group notifications (joins, leaves, etc.)."""
    group_id = notification_data.get('group_id')
    notification_type = notification_data.get('type')
    
    if notification_type == 'add':
        # Someone was added to the group
        added_by = notification_data.get('author')
        participants = notification_data.get('participants', [])
        
        logger.info(f"New participants added to group {group_id} by {added_by}: {participants}")
        
    elif notification_type == 'remove':
        # Someone was removed from the group
        removed_by = notification_data.get('author')
        participants = notification_data.get('participants', [])
        
        logger.info(f"Participants removed from group {group_id} by {removed_by}: {participants}")
        
    elif notification_type == 'subject':
        # Group subject was changed
        changed_by = notification_data.get('author')
        new_subject = notification_data.get('subject')
        
        logger.info(f"Group {group_id} subject changed to '{new_subject}' by {changed_by}")

if __name__ == "__main__":
    asyncio.run(main())</code></pre>
                    </div>
                </div>
                
                <!-- Media Handling Example -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="mb-0">Media Handling</h3>
                    </div>
                    <div class="card-body">
                        <p>Handling media files with Bocksup:</p>
                        <pre class="bg-dark text-light p-3 rounded"><code>"""
Media handling example using Bocksup.

This example demonstrates:
- Sending images, audio, and video
- Receiving and downloading media
- Processing received media files
"""

import asyncio
import logging
import os
from bocksup import create_client

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger("media_handler")

# WhatsApp credentials
PHONE_NUMBER = "your_phone_number"
PASSWORD = "your_password"

# Recipient for media messages
RECIPIENT = "recipient_number"  # Replace with actual number

# Media paths (replace with actual file paths)
IMAGE_PATH = "example_image.jpg"
AUDIO_PATH = "example_audio.mp3"
VIDEO_PATH = "example_video.mp4"

# Directory for downloaded media
DOWNLOAD_DIR = "received_media/"

async def main():
    # Create client
    client = create_client(PHONE_NUMBER, PASSWORD)
    
    # Register handlers
    client.register_message_handler(message_handler)
    
    # Create download directory if it doesn't exist
    os.makedirs(DOWNLOAD_DIR, exist_ok=True)
    
    # Connect to WhatsApp
    try:
        logger.info("Connecting to WhatsApp...")
        connected = await client.connect()
        
        if connected:
            logger.info("Connected to WhatsApp!")
            
            # Send example media files
            await send_example_media(client)
            
            # Keep the connection alive
            while True:
                await asyncio.sleep(60)
                
    except Exception as e:
        logger.error(f"Error: {e}")
    finally:
        # Disconnect when done
        await client.disconnect()
        logger.info("Disconnected from WhatsApp")

async def send_example_media(client):
    """Send example media files."""
    try:
        # Send image
        if os.path.exists(IMAGE_PATH):
            logger.info(f"Sending image: {IMAGE_PATH}")
            await client.send_image(
                RECIPIENT, 
                IMAGE_PATH, 
                caption="Test image from Bocksup"
            )
        
        # Send audio
        if os.path.exists(AUDIO_PATH):
            logger.info(f"Sending audio: {AUDIO_PATH}")
            await client.send_voice_note(RECIPIENT, AUDIO_PATH)
        
        # Send video
        if os.path.exists(VIDEO_PATH):
            logger.info(f"Sending video: {VIDEO_PATH}")
            await client.send_video(
                RECIPIENT, 
                VIDEO_PATH, 
                caption="Test video from Bocksup"
            )
    except Exception as e:
        logger.error(f"Failed to send media: {e}")

async def message_handler(message_data):
    """Handle incoming messages, especially media messages."""
    message_type = message_data.get('type')
    sender = message_data.get('from')
    
    if not sender:
        return
        
    # Handle different types of media
    if message_type in ['image', 'audio', 'video', 'document']:
        await handle_media_message(message_data)
    elif message_type == 'text':
        text = message_data.get('text', '')
        logger.info(f"Text message from {sender}: {text}")
        
        # If the message is asking for media, send an example
        if 'send me a photo' in text.lower():
            if os.path.exists(IMAGE_PATH):
                await client.send_image(sender, IMAGE_PATH, caption="Here's your requested photo")
        
async def handle_media_message(message_data):
    """Process a received media message."""
    message_type = message_data.get('type')
    sender = message_data.get('from')
    media_url = message_data.get('media_url')
    
    if not media_url:
        return
        
    try:
        # Download the media
        file_path = os.path.join(DOWNLOAD_DIR, f"{message_data.get('id')}.{get_extension(message_type)}")
        
        logger.info(f"Downloading {message_type} from {sender} to {file_path}")
        
        await client.download_media(message_data, file_path)
        
        logger.info(f"Downloaded {message_type} to {file_path}")
        
        # Process the media based on type
        if message_type == 'image':
            # You could process images here (resize, apply filters, etc.)
            # For example: process_image(file_path)
            await client.send_text_message(sender, "I received your image!")
            
        elif message_type == 'audio':
            # You could process audio here (transcribe, analyze, etc.)
            # For example: transcribe_audio(file_path)
            await client.send_text_message(sender, "I received your audio!")
            
        elif message_type == 'video':
            # You could process video here
            await client.send_text_message(sender, "I received your video!")
            
        elif message_type == 'document':
            # You could process documents here
            await client.send_text_message(sender, "I received your document!")
            
    except Exception as e:
        logger.error(f"Failed to process media message: {e}")

def get_extension(message_type):
    """Get file extension based on message type."""
    extensions = {
        'image': 'jpg',
        'audio': 'mp3',
        'video': 'mp4',
        'document': 'pdf'
    }
    return extensions.get(message_type, 'bin')

# Global client instance
client = None

if __name__ == "__main__":
    asyncio.run(main())</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="mt-5 py-3 bg-dark">
        <div class="container text-center">
            <p class="text-light mb-0">Bocksup v0.2.0 | MIT License | Not affiliated with WhatsApp Inc.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>